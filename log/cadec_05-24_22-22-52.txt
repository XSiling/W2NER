2024-05-24 22:22:52 - INFO: dict_items([('dataset', 'cadec'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 80), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 120), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 16), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'dmis-lab/biobert-base-cased-v1.2'), ('bert_learning_rate', 5e-06), ('warm_factor', 0), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/cadec.json'), ('device', 0)])
2024-05-24 22:22:52 - INFO: Loading Data
2024-05-24 22:24:19 - INFO: 
+-------+-----------+----------+
| cadec | sentences | entities |
+-------+-----------+----------+
| train |    5340   |   4428   |
|  dev  |    1097   |   898    |
|  test |    1160   |   990    |
+-------+-----------+----------+
2024-05-24 22:24:27 - INFO: Building Model
2024-05-24 22:26:48 - INFO: Has loaded the model
2024-05-24 22:26:54 - INFO: Has loaded the cuda
2024-05-24 22:26:54 - INFO: Epoch: 0
2024-05-24 22:27:29 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0295 | 0.4817 |   0.6742  | 0.4330 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:27:31 - INFO: EVAL Label F1 [0.99800542 0.6632733  0.31255646]
2024-05-24 22:27:31 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6579 |   0.8287  | 0.6165 |
| Entity | 0.3055 |   0.8317  | 0.1871 |
+--------+--------+-----------+--------+
2024-05-24 22:27:34 - INFO: TEST Label F1 [0.99815075 0.66905771 0.28595601]
2024-05-24 22:27:34 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.6511 |   0.8611  | 0.6007 |
| Entity | 0.2750 |   0.8895  | 0.1626 |
+--------+--------+-----------+--------+
2024-05-24 22:27:36 - INFO: Epoch: 1
2024-05-24 22:28:08 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0119 | 0.7059 |   0.8028  | 0.6493 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:28:10 - INFO: EVAL Label F1 [0.99840385 0.66090909 0.65236593]
2024-05-24 22:28:10 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7706 |   0.8484  | 0.7135 |
| Entity | 0.6257 |   0.7587  | 0.5323 |
+--------+--------+-----------+--------+
2024-05-24 22:28:13 - INFO: TEST Label F1 [0.99848285 0.64245601 0.66030989]
2024-05-24 22:28:13 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7671 |   0.8735  | 0.6961 |
| Entity | 0.6276 |   0.8182  | 0.5091 |
+--------+--------+-----------+--------+
2024-05-24 22:28:15 - INFO: Epoch: 2
2024-05-24 22:28:47 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0097 | 0.7729 |   0.8335  | 0.7268 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:28:49 - INFO: EVAL Label F1 [0.99831142 0.69208211 0.68965517]
2024-05-24 22:28:49 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7933 |   0.7926  | 0.7965 |
| Entity | 0.6727 |   0.7286  | 0.6247 |
+--------+--------+-----------+--------+
2024-05-24 22:28:51 - INFO: TEST Label F1 [0.99852935 0.71535022 0.71783784]
2024-05-24 22:28:51 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8106 |   0.8208  | 0.8031 |
| Entity | 0.6880 |   0.7740  | 0.6192 |
+--------+--------+-----------+--------+
2024-05-24 22:28:53 - INFO: Epoch: 3
2024-05-24 22:29:25 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0084 | 0.8070 |   0.8482  | 0.7731 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:29:27 - INFO: EVAL Label F1 [0.99839494 0.71877337 0.70738184]
2024-05-24 22:29:27 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8082 |   0.7889  | 0.8292 |
| Entity | 0.6890 |   0.6812  | 0.6971 |
+--------+--------+-----------+--------+
2024-05-24 22:29:30 - INFO: TEST Label F1 [0.99860286 0.73033364 0.74660194]
2024-05-24 22:29:30 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8252 |   0.8141  | 0.8370 |
| Entity | 0.7244 |   0.7307  | 0.7182 |
+--------+--------+-----------+--------+
2024-05-24 22:29:32 - INFO: Epoch: 4
2024-05-24 22:30:06 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0073 | 0.8273 |   0.8549  | 0.8035 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:30:08 - INFO: EVAL Label F1 [0.99844928 0.72754717 0.70671764]
2024-05-24 22:30:08 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8109 |   0.7994  | 0.8230 |
| Entity | 0.6952 |   0.7023  | 0.6882 |
+--------+--------+-----------+--------+
2024-05-24 22:30:10 - INFO: TEST Label F1 [0.99861891 0.72359963 0.75506073]
2024-05-24 22:30:10 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8258 |   0.8245  | 0.8271 |
| Entity | 0.7319 |   0.7598  | 0.7061 |
+--------+--------+-----------+--------+
2024-05-24 22:30:12 - INFO: Epoch: 5
2024-05-24 22:30:46 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0065 | 0.8497 |   0.8685  | 0.8330 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:30:48 - INFO: EVAL Label F1 [0.99846906 0.73149942 0.70525188]
2024-05-24 22:30:48 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8117 |   0.8023  | 0.8219 |
| Entity | 0.6963 |   0.7047  | 0.6882 |
+--------+--------+-----------+--------+
2024-05-24 22:30:50 - INFO: TEST Label F1 [0.99864485 0.7286385  0.75471698]
2024-05-24 22:30:50 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8273 |   0.8269  | 0.8281 |
| Entity | 0.7278 |   0.7522  | 0.7051 |
+--------+--------+-----------+--------+
2024-05-24 22:30:52 - INFO: Epoch: 6
2024-05-24 22:31:25 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0060 | 0.8614 |   0.8786  | 0.8459 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:31:27 - INFO: EVAL Label F1 [0.99839736 0.72248981 0.70638298]
2024-05-24 22:31:27 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8091 |   0.7882  | 0.8321 |
| Entity | 0.6971 |   0.6895  | 0.7049 |
+--------+--------+-----------+--------+
2024-05-24 22:31:30 - INFO: TEST Label F1 [0.99859182 0.72934132 0.75097656]
2024-05-24 22:31:30 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8263 |   0.8114  | 0.8421 |
| Entity | 0.7256 |   0.7260  | 0.7253 |
+--------+--------+-----------+--------+
2024-05-24 22:31:32 - INFO: Epoch: 7
2024-05-24 22:32:03 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0054 | 0.8756 |   0.8870  | 0.8650 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:32:05 - INFO: EVAL Label F1 [0.99852087 0.73904461 0.71092077]
2024-05-24 22:32:05 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8162 |   0.8112  | 0.8221 |
| Entity | 0.6942 |   0.6945  | 0.6938 |
+--------+--------+-----------+--------+
2024-05-24 22:32:08 - INFO: TEST Label F1 [0.99863685 0.73226112 0.74757282]
2024-05-24 22:32:08 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8262 |   0.8225  | 0.8308 |
| Entity | 0.7253 |   0.7253  | 0.7253 |
+--------+--------+-----------+--------+
2024-05-24 22:32:08 - INFO: Epoch: 8
2024-05-24 22:32:40 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0051 | 0.8886 |   0.8970  | 0.8807 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:32:43 - INFO: EVAL Label F1 [0.9985123  0.72966507 0.71596999]
2024-05-24 22:32:43 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8147 |   0.8124  | 0.8181 |
| Entity | 0.6975 |   0.7058  | 0.6893 |
+--------+--------+-----------+--------+
2024-05-24 22:32:45 - INFO: TEST Label F1 [0.99863891 0.72674976 0.7502439 ]
2024-05-24 22:32:45 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8252 |   0.8261  | 0.8256 |
| Entity | 0.7250 |   0.7395  | 0.7111 |
+--------+--------+-----------+--------+
2024-05-24 22:32:47 - INFO: Epoch: 9
2024-05-24 22:33:21 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0046 | 0.8946 |   0.9037  | 0.8860 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:33:23 - INFO: EVAL Label F1 [0.99852951 0.7358863  0.7175901 ]
2024-05-24 22:33:23 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8173 |   0.8133  | 0.8222 |
| Entity | 0.7023 |   0.7099  | 0.6949 |
+--------+--------+-----------+--------+
2024-05-24 22:33:25 - INFO: TEST Label F1 [0.99866181 0.73293109 0.75282555]
2024-05-24 22:33:25 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8281 |   0.8291  | 0.8281 |
| Entity | 0.7322 |   0.7500  | 0.7152 |
+--------+--------+-----------+--------+
2024-05-24 22:33:28 - INFO: Best DEV F1: 0.7023
2024-05-24 22:33:28 - INFO: Best TEST F1: 0.7322
2024-05-24 22:33:30 - INFO: TEST Label F1 [0.99866181 0.73293109 0.75282555]
2024-05-24 22:33:30 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.8281 |   0.8291  | 0.8281 |
|   Entity   | 0.7322 |   0.7500  | 0.7152 |
+------------+--------+-----------+--------+
