2024-05-23 03:49:00 - INFO: dict_items([('dataset', 'conll03'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 768), ('conv_hid_size', 96), ('bert_hid_size', 1024), ('biaffine_size', 768), ('ffnn_hid_size', 128), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 12), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 1.0), ('bert_name', 'bert-large-cased'), ('bert_learning_rate', 1e-05), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/conll03.json'), ('device', 0)])
2024-05-23 03:49:00 - INFO: Loading Data
2024-05-23 03:49:33 - INFO: 
+---------+-----------+----------+
| conll03 | sentences | entities |
+---------+-----------+----------+
|  train  |   17291   |  29441   |
|   dev   |    3453   |   5648   |
|   test  |    3453   |   5648   |
+---------+-----------+----------+
2024-05-23 03:49:59 - INFO: Building Model
2024-05-23 03:50:18 - INFO: Has loaded the model
2024-05-23 03:50:37 - INFO: Has loaded the cuda
2024-05-23 03:50:37 - INFO: Epoch: 0
2024-05-23 03:55:44 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0681 | 0.5176 |   0.5114  | 0.6124 |
+---------+--------+--------+-----------+--------+
2024-05-23 03:56:01 - INFO: EVAL Label F1 [0.99962115 0.94909945 0.88156008 0.78955224 0.96536524 0.92265696]
2024-05-23 03:56:01 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9180 |   0.9174  | 0.9204 |
| Entity | 0.9083 |   0.9104  | 0.9063 |
+--------+--------+-----------+--------+
2024-05-23 03:56:20 - INFO: TEST Label F1 [0.99962115 0.94909945 0.88156008 0.78955224 0.96536524 0.92265696]
2024-05-23 03:56:20 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9180 |   0.9174  | 0.9204 |
| Entity | 0.9083 |   0.9104  | 0.9063 |
+--------+--------+-----------+--------+
2024-05-23 03:56:29 - INFO: Epoch: 1
2024-05-23 04:01:44 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0027 | 0.9389 |   0.9448  | 0.9332 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:02:02 - INFO: EVAL Label F1 [0.99969453 0.9626356  0.90586146 0.81323529 0.9680422  0.93284716]
2024-05-23 04:02:02 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9304 |   0.9336  | 0.9277 |
| Entity | 0.9209 |   0.9262  | 0.9157 |
+--------+--------+-----------+--------+
2024-05-23 04:02:20 - INFO: TEST Label F1 [0.99969453 0.9626356  0.90586146 0.81323529 0.9680422  0.93284716]
2024-05-23 04:02:20 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9304 |   0.9336  | 0.9277 |
| Entity | 0.9209 |   0.9262  | 0.9157 |
+--------+--------+-----------+--------+
2024-05-23 04:02:29 - INFO: Epoch: 2
2024-05-23 04:07:51 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0017 | 0.9613 |   0.9641  | 0.9585 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:08:09 - INFO: EVAL Label F1 [0.99967083 0.9567481  0.90467626 0.80053015 0.96826385 0.93175074]
2024-05-23 04:08:09 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9269 |   0.9150  | 0.9403 |
| Entity | 0.9179 |   0.9106  | 0.9253 |
+--------+--------+-----------+--------+
2024-05-23 04:08:27 - INFO: TEST Label F1 [0.99967083 0.9567481  0.90467626 0.80053015 0.96826385 0.93175074]
2024-05-23 04:08:27 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9269 |   0.9150  | 0.9403 |
| Entity | 0.9179 |   0.9106  | 0.9253 |
+--------+--------+-----------+--------+
2024-05-23 04:08:27 - INFO: Epoch: 3
2024-05-23 04:13:54 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0013 | 0.9723 |   0.9728  | 0.9718 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:14:12 - INFO: EVAL Label F1 [0.99968245 0.9561493  0.90833581 0.82559775 0.96513076 0.92768228]
2024-05-23 04:14:12 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9304 |   0.9267  | 0.9343 |
| Entity | 0.9185 |   0.9162  | 0.9209 |
+--------+--------+-----------+--------+
2024-05-23 04:14:30 - INFO: TEST Label F1 [0.99968245 0.9561493  0.90833581 0.82559775 0.96513076 0.92768228]
2024-05-23 04:14:30 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9304 |   0.9267  | 0.9343 |
| Entity | 0.9185 |   0.9162  | 0.9209 |
+--------+--------+-----------+--------+
2024-05-23 04:14:30 - INFO: Epoch: 4
2024-05-23 04:19:53 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0010 | 0.9786 |   0.9794  | 0.9779 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:20:10 - INFO: EVAL Label F1 [0.9997038  0.96274038 0.90183513 0.83333333 0.96653112 0.93592814]
2024-05-23 04:20:10 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9333 |   0.9308  | 0.9364 |
| Entity | 0.9222 |   0.9188  | 0.9256 |
+--------+--------+-----------+--------+
2024-05-23 04:20:27 - INFO: TEST Label F1 [0.9997038  0.96274038 0.90183513 0.83333333 0.96653112 0.93592814]
2024-05-23 04:20:27 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9333 |   0.9308  | 0.9364 |
| Entity | 0.9222 |   0.9188  | 0.9256 |
+--------+--------+-----------+--------+
2024-05-23 04:20:38 - INFO: Epoch: 5
2024-05-23 04:25:57 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0006 | 0.9845 |   0.9843  | 0.9847 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:26:14 - INFO: EVAL Label F1 [0.99972655 0.96441423 0.91669191 0.83669215 0.97024179 0.93512706]
2024-05-23 04:26:14 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9371 |   0.9325  | 0.9421 |
| Entity | 0.9273 |   0.9266  | 0.9279 |
+--------+--------+-----------+--------+
2024-05-23 04:26:33 - INFO: TEST Label F1 [0.99972655 0.96441423 0.91669191 0.83669215 0.97024179 0.93512706]
2024-05-23 04:26:33 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9371 |   0.9325  | 0.9421 |
| Entity | 0.9273 |   0.9266  | 0.9279 |
+--------+--------+-----------+--------+
2024-05-23 04:26:42 - INFO: Epoch: 6
2024-05-23 04:31:59 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0005 | 0.9879 |   0.9878  | 0.9879 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:32:17 - INFO: EVAL Label F1 [0.99971076 0.96042738 0.90991262 0.82147838 0.96790277 0.92733157]
2024-05-23 04:32:17 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9311 |   0.9230  | 0.9397 |
| Entity | 0.9207 |   0.9161  | 0.9255 |
+--------+--------+-----------+--------+
2024-05-23 04:32:35 - INFO: TEST Label F1 [0.99971076 0.96042738 0.90991262 0.82147838 0.96790277 0.92733157]
2024-05-23 04:32:35 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9311 |   0.9230  | 0.9397 |
| Entity | 0.9207 |   0.9161  | 0.9255 |
+--------+--------+-----------+--------+
2024-05-23 04:32:35 - INFO: Epoch: 7
2024-05-23 04:37:55 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0004 | 0.9906 |   0.9905  | 0.9908 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:38:12 - INFO: EVAL Label F1 [0.99972052 0.96367265 0.9180622  0.83618234 0.96984768 0.93695847]
2024-05-23 04:38:12 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9374 |   0.9342  | 0.9408 |
| Entity | 0.9284 |   0.9279  | 0.9290 |
+--------+--------+-----------+--------+
2024-05-23 04:38:30 - INFO: TEST Label F1 [0.99972052 0.96367265 0.9180622  0.83618234 0.96984768 0.93695847]
2024-05-23 04:38:30 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9374 |   0.9342  | 0.9408 |
| Entity | 0.9284 |   0.9279  | 0.9290 |
+--------+--------+-----------+--------+
2024-05-23 04:38:40 - INFO: Epoch: 8
2024-05-23 04:43:58 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0003 | 0.9932 |   0.9930  | 0.9934 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:44:15 - INFO: EVAL Label F1 [0.99971494 0.96185936 0.91171277 0.83535282 0.97003745 0.93591654]
2024-05-23 04:44:15 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9299  | 0.9420 |
| Entity | 0.9266 |   0.9226  | 0.9306 |
+--------+--------+-----------+--------+
2024-05-23 04:44:34 - INFO: TEST Label F1 [0.99971494 0.96185936 0.91171277 0.83535282 0.97003745 0.93591654]
2024-05-23 04:44:34 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9299  | 0.9420 |
| Entity | 0.9266 |   0.9226  | 0.9306 |
+--------+--------+-----------+--------+
2024-05-23 04:44:34 - INFO: Epoch: 9
2024-05-23 04:49:53 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0002 | 0.9944 |   0.9941  | 0.9947 |
+---------+--------+--------+-----------+--------+
2024-05-23 04:50:11 - INFO: EVAL Label F1 [0.99972144 0.96348034 0.91679093 0.83623693 0.97164226 0.93779904]
2024-05-23 04:50:11 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9376 |   0.9316  | 0.9439 |
| Entity | 0.9284 |   0.9257  | 0.9311 |
+--------+--------+-----------+--------+
2024-05-23 04:50:29 - INFO: TEST Label F1 [0.99972144 0.96348034 0.91679093 0.83623693 0.97164226 0.93779904]
2024-05-23 04:50:29 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9376 |   0.9316  | 0.9439 |
| Entity | 0.9284 |   0.9257  | 0.9311 |
+--------+--------+-----------+--------+
2024-05-23 04:50:29 - INFO: Best DEV F1: 0.9284
2024-05-23 04:50:29 - INFO: Best TEST F1: 0.9284
2024-05-23 04:50:51 - INFO: TEST Label F1 [0.99972052 0.96367265 0.9180622  0.83618234 0.96984768 0.93695847]
2024-05-23 04:50:51 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9374 |   0.9342  | 0.9408 |
|   Entity   | 0.9284 |   0.9279  | 0.9290 |
+------------+--------+-----------+--------+
