2024-05-24 21:35:01 - INFO: dict_items([('dataset', 'conll03'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 768), ('conv_hid_size', 96), ('bert_hid_size', 1024), ('biaffine_size', 768), ('ffnn_hid_size', 128), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 12), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 1.0), ('bert_name', 'bert-large-cased'), ('bert_learning_rate', 1e-05), ('warm_factor', 0.1), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/conll03.json'), ('device', 0)])
2024-05-24 21:35:01 - INFO: Loading Data
2024-05-24 21:35:53 - INFO: 
+---------+-----------+----------+
| conll03 | sentences | entities |
+---------+-----------+----------+
|  train  |   17291   |  29441   |
|   dev   |    3453   |   5648   |
|   test  |    3453   |   5648   |
+---------+-----------+----------+
2024-05-24 21:36:13 - INFO: Building Model
2024-05-24 21:36:33 - INFO: Has loaded the model
2024-05-24 21:36:42 - INFO: Has loaded the cuda
2024-05-24 21:36:42 - INFO: Epoch: 0
2024-05-24 21:40:45 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0702 | 0.5073 |   0.4845  | 0.6050 |
+---------+--------+--------+-----------+--------+
2024-05-24 21:40:55 - INFO: EVAL Label F1 [0.99955425 0.92398104 0.88114879 0.76210526 0.95455932 0.9057715 ]
2024-05-24 21:40:55 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9045 |   0.8907  | 0.9200 |
| Entity | 0.8952 |   0.8897  | 0.9008 |
+--------+--------+-----------+--------+
2024-05-24 21:41:06 - INFO: TEST Label F1 [0.99955425 0.92398104 0.88114879 0.76210526 0.95455932 0.9057715 ]
2024-05-24 21:41:06 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9045 |   0.8907  | 0.9200 |
| Entity | 0.8952 |   0.8897  | 0.9008 |
+--------+--------+-----------+--------+
2024-05-24 21:41:11 - INFO: Epoch: 1
2024-05-24 21:45:06 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0029 | 0.9376 |   0.9445  | 0.9311 |
+---------+--------+--------+-----------+--------+
2024-05-24 21:45:17 - INFO: EVAL Label F1 [0.99968059 0.95621019 0.90066609 0.83249461 0.96971589 0.92972315]
2024-05-24 21:45:17 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9314 |   0.9282  | 0.9353 |
| Entity | 0.9212 |   0.9212  | 0.9212 |
+--------+--------+-----------+--------+
2024-05-24 21:45:28 - INFO: TEST Label F1 [0.99968059 0.95621019 0.90066609 0.83249461 0.96971589 0.92972315]
2024-05-24 21:45:28 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9314 |   0.9282  | 0.9353 |
| Entity | 0.9212 |   0.9212  | 0.9212 |
+--------+--------+-----------+--------+
2024-05-24 21:45:32 - INFO: Epoch: 2
2024-05-24 21:49:30 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0019 | 0.9601 |   0.9633  | 0.9569 |
+---------+--------+--------+-----------+--------+
2024-05-24 21:49:41 - INFO: EVAL Label F1 [0.99970197 0.96422074 0.91330891 0.80469289 0.9655814  0.93374046]
2024-05-24 21:49:41 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9302 |   0.9311  | 0.9297 |
| Entity | 0.9208 |   0.9292  | 0.9125 |
+--------+--------+-----------+--------+
2024-05-24 21:49:51 - INFO: TEST Label F1 [0.99970197 0.96422074 0.91330891 0.80469289 0.9655814  0.93374046]
2024-05-24 21:49:51 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9302 |   0.9311  | 0.9297 |
| Entity | 0.9208 |   0.9292  | 0.9125 |
+--------+--------+-----------+--------+
2024-05-24 21:49:51 - INFO: Epoch: 3
2024-05-24 21:53:50 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0013 | 0.9706 |   0.9711  | 0.9700 |
+---------+--------+--------+-----------+--------+
2024-05-24 21:54:01 - INFO: EVAL Label F1 [0.99973445 0.96677342 0.9209973  0.83741007 0.97057913 0.93587417]
2024-05-24 21:54:01 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9386 |   0.9392  | 0.9381 |
| Entity | 0.9301 |   0.9357  | 0.9246 |
+--------+--------+-----------+--------+
2024-05-24 21:54:11 - INFO: TEST Label F1 [0.99973445 0.96677342 0.9209973  0.83741007 0.97057913 0.93587417]
2024-05-24 21:54:11 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9386 |   0.9392  | 0.9381 |
| Entity | 0.9301 |   0.9357  | 0.9246 |
+--------+--------+-----------+--------+
2024-05-24 21:54:16 - INFO: Epoch: 4
2024-05-24 21:58:13 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0009 | 0.9800 |   0.9802  | 0.9797 |
+---------+--------+--------+-----------+--------+
2024-05-24 21:58:23 - INFO: EVAL Label F1 [0.99971726 0.96410052 0.91810089 0.83161512 0.96522007 0.93649347]
2024-05-24 21:58:23 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9359 |   0.9278  | 0.9446 |
| Entity | 0.9267 |   0.9226  | 0.9308 |
+--------+--------+-----------+--------+
2024-05-24 21:58:34 - INFO: TEST Label F1 [0.99971726 0.96410052 0.91810089 0.83161512 0.96522007 0.93649347]
2024-05-24 21:58:34 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9359 |   0.9278  | 0.9446 |
| Entity | 0.9267 |   0.9226  | 0.9308 |
+--------+--------+-----------+--------+
2024-05-24 21:58:34 - INFO: Epoch: 5
2024-05-24 22:02:32 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0007 | 0.9840 |   0.9834  | 0.9846 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:02:42 - INFO: EVAL Label F1 [0.99970844 0.96190476 0.91641968 0.81799308 0.96708075 0.93725371]
2024-05-24 22:02:42 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9334 |   0.9263  | 0.9410 |
| Entity | 0.9250 |   0.9231  | 0.9269 |
+--------+--------+-----------+--------+
2024-05-24 22:02:53 - INFO: TEST Label F1 [0.99970844 0.96190476 0.91641968 0.81799308 0.96708075 0.93725371]
2024-05-24 22:02:53 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9334 |   0.9263  | 0.9410 |
| Entity | 0.9250 |   0.9231  | 0.9269 |
+--------+--------+-----------+--------+
2024-05-24 22:02:53 - INFO: Epoch: 6
2024-05-24 22:06:49 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0006 | 0.9885 |   0.9883  | 0.9887 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:07:00 - INFO: EVAL Label F1 [0.99969915 0.95576619 0.92192641 0.83798883 0.96800249 0.93158834]
2024-05-24 22:07:00 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9276  | 0.9444 |
| Entity | 0.9273 |   0.9225  | 0.9320 |
+--------+--------+-----------+--------+
2024-05-24 22:07:10 - INFO: TEST Label F1 [0.99969915 0.95576619 0.92192641 0.83798883 0.96800249 0.93158834]
2024-05-24 22:07:10 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9276  | 0.9444 |
| Entity | 0.9273 |   0.9225  | 0.9320 |
+--------+--------+-----------+--------+
2024-05-24 22:07:10 - INFO: Epoch: 7
2024-05-24 22:11:07 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0004 | 0.9908 |   0.9906  | 0.9910 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:11:18 - INFO: EVAL Label F1 [0.99972237 0.966      0.91754123 0.83471074 0.96722325 0.93377285]
2024-05-24 22:11:18 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9365 |   0.9291  | 0.9442 |
| Entity | 0.9264 |   0.9226  | 0.9302 |
+--------+--------+-----------+--------+
2024-05-24 22:11:28 - INFO: TEST Label F1 [0.99972237 0.966      0.91754123 0.83471074 0.96722325 0.93377285]
2024-05-24 22:11:28 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9365 |   0.9291  | 0.9442 |
| Entity | 0.9264 |   0.9226  | 0.9302 |
+--------+--------+-----------+--------+
2024-05-24 22:11:28 - INFO: Epoch: 8
2024-05-24 22:15:24 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0003 | 0.9935 |   0.9932  | 0.9937 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:15:34 - INFO: EVAL Label F1 [0.99972005 0.96387947 0.91760522 0.83168317 0.96796267 0.93590129]
2024-05-24 22:15:34 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9361 |   0.9318  | 0.9406 |
| Entity | 0.9266 |   0.9246  | 0.9286 |
+--------+--------+-----------+--------+
2024-05-24 22:15:45 - INFO: TEST Label F1 [0.99972005 0.96387947 0.91760522 0.83168317 0.96796267 0.93590129]
2024-05-24 22:15:45 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9361 |   0.9318  | 0.9406 |
| Entity | 0.9266 |   0.9246  | 0.9286 |
+--------+--------+-----------+--------+
2024-05-24 22:15:45 - INFO: Epoch: 9
2024-05-24 22:19:43 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0002 | 0.9944 |   0.9941  | 0.9946 |
+---------+--------+--------+-----------+--------+
2024-05-24 22:19:53 - INFO: EVAL Label F1 [0.99971355 0.96293344 0.92001189 0.82662968 0.96776193 0.93795181]
2024-05-24 22:19:53 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9288  | 0.9432 |
| Entity | 0.9274 |   0.9238  | 0.9311 |
+--------+--------+-----------+--------+
2024-05-24 22:20:04 - INFO: TEST Label F1 [0.99971355 0.96293344 0.92001189 0.82662968 0.96776193 0.93795181]
2024-05-24 22:20:04 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.9358 |   0.9288  | 0.9432 |
| Entity | 0.9274 |   0.9238  | 0.9311 |
+--------+--------+-----------+--------+
2024-05-24 22:20:04 - INFO: Best DEV F1: 0.9301
2024-05-24 22:20:04 - INFO: Best TEST F1: 0.9301
2024-05-24 22:20:16 - INFO: TEST Label F1 [0.99973445 0.96677342 0.9209973  0.83741007 0.97057913 0.93587417]
2024-05-24 22:20:16 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.9386 |   0.9392  | 0.9381 |
|   Entity   | 0.9301 |   0.9357  | 0.9246 |
+------------+--------+-----------+--------+
